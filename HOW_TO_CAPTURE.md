# Galmuri Diary 캡처 기능 사용 가이드

## 캡처란?

Galmuri Diary의 **캡처**는 현재 보고 있는 화면(웹 페이지 또는 이미지)을 저장하여 나중에 검색하고 찾을 수 있게 하는 기능입니다.

## 사용 방법

### 방법 1: Chrome Extension 사용 (웹 페이지 캡처) 🌐

#### 1단계: Extension 설치

1. Chrome 브라우저 열기
2. `chrome://extensions/` 접속
3. 우측 상단 **"개발자 모드"** 활성화
4. **"압축해제된 확장 프로그램을 로드합니다"** 클릭
5. `/Users/john/gal/extension` 폴더 선택
6. Extension이 설치되었는지 확인

#### 2단계: Extension 설정

1. Extension 아이콘 클릭 (브라우저 툴바)
2. **"설정"** 탭 클릭
3. 다음 정보 입력:
   ```
   API URL: https://your-app.onrender.com
   API Key: test_api_key_1234567890
   User ID: 550e8400-e29b-41d4-a716-446655440000 (UUID 형식)
   ```
4. **"설정 저장"** 클릭

#### 3단계: 웹 페이지 캡처

1. **저장하고 싶은 웹 페이지로 이동**
   - 예: 뉴스 기사, 블로그 포스트, 쇼핑몰 상품 등
   
2. **Extension 아이콘 클릭**
   - 브라우저 툴바의 Galmuri Diary 아이콘
   - 또는 주소창 옆의 확장 프로그램 아이콘

3. **자동으로 캡처됨**
   - 현재 페이지의 스크린샷이 자동으로 찍힘
   - 페이지 제목과 URL이 자동으로 추출됨

4. **메모 입력 (선택사항)**
   - 팝업 창에서 메모 입력란에 추가 정보 입력
   - 예: "나중에 읽을 기사", "참고 자료" 등

5. **"저장" 버튼 클릭**
   - 즉시 저장됨 (로컬에 먼저 저장)
   - 서버와 자동 동기화
   - OCR 처리가 백그라운드에서 시작됨

#### 실제 사용 예시

**시나리오: 뉴스 기사 저장**
1. 흥미로운 뉴스 기사 발견
2. Extension 아이콘 클릭
3. 메모: "주식 관련, 나중에 분석"
4. 저장 클릭
5. ✅ 완료! 나중에 "주식"으로 검색하면 찾을 수 있음

**시나리오: 쇼핑 상품 저장**
1. 마음에 드는 상품 페이지 방문
2. Extension 클릭
3. 메모: "생일 선물 후보"
4. 저장
5. ✅ 완료!

---

### 방법 2: Android App 사용 (스크린샷 캡처) 📱

#### 1단계: 앱 설치 및 설정

1. **APK 설치** (또는 Flutter로 빌드)
2. **앱 실행**
3. **설정 화면**으로 이동
4. 다음 정보 입력:
   ```
   API URL: https://your-app.onrender.com
   API Key: test_api_key_1234567890
   User ID: 550e8400-e29b-41d4-a716-446655440000
   ```
5. **"설정 저장"** 클릭

#### 2단계: 이미지 캡처

1. **앱 실행**
2. **하단 "캡처" 버튼** 클릭 (플로팅 액션 버튼)

3. **이미지 선택 방법:**
   
   **옵션 A: 갤러리에서 선택**
   - "갤러리" 버튼 클릭
   - 원하는 이미지 선택
   - 이미지가 미리보기로 표시됨
   
   **옵션 B: 카메라로 촬영**
   - "카메라" 버튼 클릭
   - 사진 촬영
   - 촬영한 사진이 미리보기로 표시됨

4. **정보 입력:**
   - **제목** 입력 (필수)
     - 예: "회의 자료", "명함", "메뉴판" 등
   - **메모** 입력 (선택사항)
     - 예: "2025년 1월 회의", "김철수님 명함" 등

5. **"저장" 버튼 클릭** (우측 상단 체크 아이콘)
   - 로컬에 즉시 저장
   - 서버와 자동 동기화
   - OCR 처리 시작

#### 실제 사용 예시

**시나리오: 명함 저장**
1. 명함을 카메라로 촬영
2. 제목: "김철수 - ABC 회사"
3. 메모: "2025년 1월 만남, 연락처 필요"
4. 저장
5. ✅ 나중에 "김철수" 또는 "ABC"로 검색 가능

**시나리오: 메뉴판 저장**
1. 식당 메뉴판 사진 촬영
2. 제목: "맛있는 식당 메뉴"
3. 메모: "강남역 근처, 가격 확인"
4. 저장
5. ✅ OCR로 메뉴 이름도 검색 가능

---

## 캡처 후 활용

### 1. 검색하기

**Chrome Extension:**
- Extension 아이콘 클릭
- "검색" 탭
- 검색어 입력

**Android App:**
- 앱 실행
- 상단 검색 아이콘 클릭
- 검색어 입력

**검색 범위:**
- ✅ 제목
- ✅ 메모
- ✅ OCR 텍스트 (이미지 안의 글자)

**예시:**
- "배달" 검색 → 배달 앱 스크린샷, 배달 관련 이미지 모두 찾음
- "회의" 검색 → 회의 자료, 회의록 등 찾음

### 2. 저장된 항목 보기

**Chrome Extension:**
- Extension → "캡처" 탭 (홈 화면)
- 최근 저장된 항목 목록 확인

**Android App:**
- 앱 홈 화면
- 최근 저장된 항목 목록 확인
- 각 항목 클릭하여 상세 보기

### 3. 동기화 확인

- 로컬에 먼저 저장 (오프라인에서도 작동)
- 네트워크 연결 시 자동으로 서버와 동기화
- 여러 기기에서 같은 데이터 접근 가능

---

## 캡처 데이터 구조

각 캡처는 다음 정보를 포함합니다:

```json
{
  "id": "고유 ID",
  "user_id": "사용자 ID",
  "image_data": "이미지 (Base64 또는 파일 경로)",
  "source_url": "원본 URL (웹 페이지인 경우)",
  "page_title": "제목",
  "memo_content": "메모",
  "ocr_text": "OCR로 추출된 텍스트",
  "ocr_status": "PENDING | DONE | FAILED",
  "platform": "WEB_EXTENSION | MOBILE_APP",
  "created_at": "생성 시간"
}
```

---

## 캡처 사용 팁

### 💡 효과적인 캡처 방법

1. **명확한 제목 사용**
   - 나중에 찾기 쉬운 제목
   - 예: "2025년 1월 회의 자료" (날짜 포함)

2. **메모 활용**
   - 추가 정보, 태그, 링크 등
   - 예: "#중요 #참고 #나중에읽기"

3. **OCR 활용**
   - 이미지 안의 텍스트도 검색됨
   - 명함, 메뉴판, 문서 등에 유용

4. **정기적인 캡처**
   - 흥미로운 내용을 즉시 캡처
   - 나중에 정리하는 습관

### ⚠️ 주의사항

1. **이미지 품질**
   - 선명한 이미지일수록 OCR 정확도 높음
   - 흐릿하거나 작은 글자는 인식 어려울 수 있음

2. **OCR 처리 시간**
   - 처음에는 `ocr_status: PENDING`
   - 백그라운드에서 처리되므로 시간이 걸릴 수 있음
   - 완료되면 `ocr_status: DONE`

3. **저장 용량**
   - 이미지는 Base64로 인코딩되어 저장
   - 큰 이미지는 용량이 클 수 있음

---

## 문제 해결

### Extension이 작동하지 않음

1. **설정 확인**
   - API URL이 올바른지
   - API Key가 입력되었는지
   - User ID가 UUID 형식인지

2. **권한 확인**
   - Extension이 활성화되어 있는지
   - 필요한 권한이 허용되었는지

3. **서버 확인**
   - Render 서버가 실행 중인지
   - `/` 엔드포인트로 확인

### Android App이 작동하지 않음

1. **설정 확인**
   - API URL, API Key, User ID 확인

2. **권한 확인**
   - 카메라 권한
   - 저장소 권한

3. **네트워크 확인**
   - 인터넷 연결 확인
   - API 서버 접근 가능한지

### 캡처는 되지만 저장이 안 됨

1. **로그 확인**
   - Extension: 브라우저 콘솔 (F12)
   - App: 로그 확인

2. **서버 확인**
   - Render 로그 확인
   - 에러 메시지 확인

3. **데이터베이스 확인**
   - PostgreSQL 연결 확인
   - `DATABASE_URL` 환경 변수 확인

---

## 요약

### Chrome Extension
1. Extension 설치
2. 설정 (API URL, Key, User ID)
3. 웹 페이지에서 Extension 클릭
4. 메모 입력 (선택)
5. 저장

### Android App
1. 앱 설치 및 설정
2. "캡처" 버튼 클릭
3. 이미지 선택/촬영
4. 제목 및 메모 입력
5. 저장

### 핵심 기능
- ✅ 즉시 저장 (로컬 우선)
- ✅ 자동 동기화
- ✅ OCR 텍스트 추출
- ✅ 검색 가능 (제목, 메모, OCR)

---

## 다음 단계

1. ✅ 첫 캡처 시도
2. ✅ 검색 기능 테스트
3. ✅ 여러 항목 저장
4. ✅ OCR 처리 확인 (시간이 걸릴 수 있음)

