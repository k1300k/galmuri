# Galmuri Diary 캡처 기능 사용 가이드

## 캡처란?

Galmuri Diary의 **캡처**는 현재 보고 있는 화면(웹 페이지 또는 이미지)을 저장하여 나중에 검색하고 찾을 수 있게 하는 기능입니다.

## 사용 방법

### 방법 1: Chrome Extension 사용 (웹 페이지 캡처) 🌐

#### 1단계: Extension 설치

1. Chrome 브라우저 열기
2. `chrome://extensions/` 접속
3. 우측 상단 **"개발자 모드"** 활성화
4. **"압축해제된 확장 프로그램을 로드합니다"** 클릭
5. `/Users/john/gal/extension` 폴더 선택
6. Extension이 설치되었는지 확인

#### 2단계: Extension 설정

1. Extension 아이콘 클릭 (브라우저 툴바)
2. **"설정"** 탭 클릭
3. 다음 정보 입력:
   ```
   API URL: https://your-app.onrender.com
   API Key: test_api_key_1234567890
   User ID: 550e8400-e29b-41d4-a716-446655440000 (UUID 형식)
   ```
4. **"설정 저장"** 클릭

#### 3단계: 웹 페이지 캡처

1. **저장하고 싶은 웹 페이지로 이동**
   - 예: 뉴스 기사, 블로그 포스트, 쇼핑몰 상품 등
   
2. **Extension 아이콘 클릭**
   - 브라우저 툴바의 Galmuri Diary 아이콘
   - 또는 주소창 옆의 확장 프로그램 아이콘

3. **자동으로 캡처됨**
   - 현재 페이지의 스크린샷이 자동으로 찍힘
   - 페이지 제목과 URL이 자동으로 추출됨

4. **메모 입력 (선택사항)**
   - 팝업 창에서 메모 입력란에 추가 정보 입력
   - 예: "나중에 읽을 기사", "참고 자료" 등

5. **"저장" 버튼 클릭**
   - 즉시 저장됨 (로컬에 먼저 저장)
   - 서버와 자동 동기화
   - OCR 처리가 백그라운드에서 시작됨

#### 실제 사용 예시

**시나리오: 뉴스 기사 저장**
1. 흥미로운 뉴스 기사 발견
2. Extension 아이콘 클릭
3. 메모: "주식 관련, 나중에 분석"
4. 저장 클릭
5. ✅ 완료! 나중에 "주식"으로 검색하면 찾을 수 있음

**시나리오: 쇼핑 상품 저장**
1. 마음에 드는 상품 페이지 방문
2. Extension 클릭
3. 메모: "생일 선물 후보"
4. 저장
5. ✅ 완료!

---

### 방법 2: Android App 사용 (실시간 화면 캡처) 📱

#### 1단계: 앱 설치 및 설정

1. **APK 다운로드** 
   - GitHub Actions: https://github.com/k1300k/galmuri/actions
   - Artifacts에서 APK 다운로드
2. **APK 설치**
3. **앱 실행**
4. **설정 화면**으로 이동 (우측 상단 설정 아이콘)
5. 다음 정보 입력:
   ```
   User ID: 550e8400-e29b-41d4-a716-446655440000
   API URL: https://your-app.onrender.com (선택사항)
   API Key: test_api_key_1234567890 (선택사항)
   ```
6. **"설정 저장"** 클릭

#### 2단계: 실시간 화면 캡처 (간단! 3단계만)

**✨ 새로운 간편 캡처 방식**

1. **"캡처" 버튼 클릭**
   - 홈 화면 하단의 파란색 "캡처" 버튼 클릭
   - 권한 요청 (최초 1회만):
     - 오버레이 권한 허용
     - 화면 캡처 권한 허용 (**주의: 팝업에서 반드시 '전체 화면'을 선택하세요**)

2. **다른 앱으로 이동**
   - 화면 상단에 빨간색 "화면 캡처" 버튼 표시
   - 버튼을 드래그하여 원하는 위치로 이동 가능
   - 캡처할 화면으로 이동 (카카오톡, 인스타그램, 브라우저 등)

3. **"화면 캡처" 버튼 클릭**
   - 현재 화면이 자동으로 캡처됨
   - 자동으로 저장됨 (제목 자동 생성)
   - 2초 후 홈 화면으로 자동 이동
   - ✅ 완료!

#### 추가 옵션: 수동 이미지 추가

갤러리나 카메라에서 이미지를 추가하려면:

1. 홈 화면에서 메뉴 → "새 캡처"
2. **이미지 선택:**
   - **갤러리**: 저장된 이미지 선택
   - **카메라**: 새로 촬영
3. 제목/메모 입력 (선택사항)
4. 저장

#### 실제 사용 예시

**시나리오: 카카오톡 대화 저장**
1. 앱에서 "캡처" 버튼 클릭
2. 카카오톡 실행
3. 대화 화면에서 "화면 캡처" 버튼 클릭
4. ✅ 자동 저장 완료! (제목: "화면 캡처 2025-01-22 14:30")

**시나리오: 인스타그램 게시물 저장**
1. 앱에서 "캡처" 버튼 클릭
2. 인스타그램 실행
3. 저장할 게시물에서 "화면 캡처" 버튼 클릭
4. ✅ 자동 저장 완료!

**시나리오: 웹 페이지 스크린샷**
1. 앱에서 "캡처" 버튼 클릭
2. 크롬 브라우저 실행
3. 저장할 페이지에서 "화면 캡처" 버튼 클릭
4. ✅ 자동 저장 완료!

#### 주요 특징

- **드래그 가능**: 캡처 버튼을 원하는 위치로 이동
- **자동 저장**: 수동 입력 불필요
- **빠른 반복**: 여러 화면을 연속으로 빠르게 캡처 가능
- **위치 기억**: 마지막 버튼 위치를 기억

---

## 캡처 후 활용

### 1. 검색하기

**Chrome Extension:**
- Extension 아이콘 클릭
- "검색" 탭
- 검색어 입력

**Android App:**
- 앱 실행
- 상단 검색 아이콘 클릭
- 검색어 입력

**검색 범위:**
- ✅ 제목
- ✅ 메모
- ✅ OCR 텍스트 (이미지 안의 글자)

**예시:**
- "배달" 검색 → 배달 앱 스크린샷, 배달 관련 이미지 모두 찾음
- "회의" 검색 → 회의 자료, 회의록 등 찾음

### 2. 저장된 항목 보기

**Chrome Extension:**
- Extension → "캡처" 탭 (홈 화면)
- 최근 저장된 항목 목록 확인

**Android App:**
- 앱 홈 화면
- 최근 저장된 항목 목록 확인
- 각 항목 클릭하여 상세 보기

### 3. 동기화 확인

- 로컬에 먼저 저장 (오프라인에서도 작동)
- 네트워크 연결 시 자동으로 서버와 동기화
- 여러 기기에서 같은 데이터 접근 가능

---

## 캡처 데이터 구조

각 캡처는 다음 정보를 포함합니다:

```json
{
  "id": "고유 ID",
  "user_id": "사용자 ID",
  "image_data": "이미지 (Base64 또는 파일 경로)",
  "source_url": "원본 URL (웹 페이지인 경우)",
  "page_title": "제목",
  "memo_content": "메모",
  "ocr_text": "OCR로 추출된 텍스트",
  "ocr_status": "PENDING | DONE | FAILED",
  "platform": "WEB_EXTENSION | MOBILE_APP",
  "created_at": "생성 시간"
}
```

---

## 캡처 사용 팁

### 💡 효과적인 캡처 방법

1. **명확한 제목 사용**
   - 나중에 찾기 쉬운 제목
   - 예: "2025년 1월 회의 자료" (날짜 포함)

2. **메모 활용**
   - 추가 정보, 태그, 링크 등
   - 예: "#중요 #참고 #나중에읽기"

3. **OCR 활용**
   - 이미지 안의 텍스트도 검색됨
   - 명함, 메뉴판, 문서 등에 유용

4. **정기적인 캡처**
   - 흥미로운 내용을 즉시 캡처
   - 나중에 정리하는 습관

### ⚠️ 주의사항

1. **이미지 품질**
   - 선명한 이미지일수록 OCR 정확도 높음
   - 흐릿하거나 작은 글자는 인식 어려울 수 있음

2. **OCR 처리 시간**
   - 처음에는 `ocr_status: PENDING`
   - 백그라운드에서 처리되므로 시간이 걸릴 수 있음
   - 완료되면 `ocr_status: DONE`

3. **저장 용량**
   - 이미지는 Base64로 인코딩되어 저장
   - 큰 이미지는 용량이 클 수 있음

---

## 문제 해결

### Extension이 작동하지 않음

1. **설정 확인**
   - API URL이 올바른지
   - API Key가 입력되었는지
   - User ID가 UUID 형식인지

2. **권한 확인**
   - Extension이 활성화되어 있는지
   - 필요한 권한이 허용되었는지

3. **서버 확인**
   - Render 서버가 실행 중인지
   - `/` 엔드포인트로 확인

### Android App이 작동하지 않음

1. **설정 확인**
   - API URL, API Key, User ID 확인

2. **권한 확인**
   - 카메라 권한
   - 저장소 권한

3. **네트워크 확인**
   - 인터넷 연결 확인
   - API 서버 접근 가능한지

### 캡처는 되지만 저장이 안 됨

1. **로그 확인**
   - Extension: 브라우저 콘솔 (F12)
   - App: 로그 확인

2. **서버 확인**
   - Render 로그 확인
   - 에러 메시지 확인

3. **데이터베이스 확인**
   - PostgreSQL 연결 확인
   - `DATABASE_URL` 환경 변수 확인

---

## 요약

### Chrome Extension
1. Extension 설치
2. 설정 (API URL, Key, User ID)
3. 웹 페이지에서 Extension 클릭
4. 메모 입력 (선택)
5. 저장

### Android App
1. 앱 설치 및 설정
2. "캡처" 버튼 클릭
3. 이미지 선택/촬영
4. 제목 및 메모 입력
5. 저장

### 핵심 기능
- ✅ 즉시 저장 (로컬 우선)
- ✅ 자동 동기화
- ✅ OCR 텍스트 추출
- ✅ 검색 가능 (제목, 메모, OCR)

---

## 다음 단계

1. ✅ 첫 캡처 시도
2. ✅ 검색 기능 테스트
3. ✅ 여러 항목 저장
4. ✅ OCR 처리 확인 (시간이 걸릴 수 있음)

